## Определение стоимости автомобилей

Сервисом по продаже автомобилей с пробегом «Не бит, не крашен» поставлена задача: обучить модель для определения рыночной стоимости автомобиля. Важно, чтобы значение метрики качества RMSE было меньше 2500.

Для решения задачи были проделаны следующие шаги:

1 Подготовка данных

Итоги обзора исходных данных:

В данных 354369 записей и 16 признаков. Есть пропуски.
Имеются 4 явных дубликата.
Признак NumberOfPictures среди значений имеет только нули.
Есть нулевое значение в целевом признаке.
Есть нулевое значение и в значениях мощности двигателя. Теоретически кто-то мог выставить на продажу автомобиль не на ходу. Хотя вероятнее, что значение просто забыли указать, а 0 выствляется стандартно при оформлении анкеты. Максимальное значение признака — 20000 л. с.
RegistrationYear в качестве самого раннего года регистрации автомобиля имеет 1000-ый год. Максимальное значение — 9999.
С месяцем регистрации тоже что-то непонятное, имеется нулевое значение.
Признак Repaired имеет больше 70 тыс. пропусков.
Итоги предобработки данных:

Удалены записи с годом регистрации автомобиля до 1900-го и после 2016-го.
Выборка ограничена записями с мощностью двигателя автомобиля до 2300 л. с.
Удалены записи с бесплатными автомобилями.
Нулевые значения мощности двигателя заполнены медианой в зависимости от брэнда и модели автомобиля. Пропуски, которые не получилось заполнить, были удалены.
Добавлен признак repaired_advanced. Он включил в себя значения признака Rpaired с заполнением пропусков значением not specified.
Были сброшены явные дубликаты.
Оставшиеся пропуски заполнены наиболее частым значением.
Анализ корреляции:

Наблюдается заметная связь таргета с моделью автомобиля и годом регистрации: 0.57—0.58.
Как и ожидалось, почтовый индекс почти не имеет связи с ценой автомобиля. У значений месяца регистрации есть слабая связь с таргетом, однако мы оставили в данных значения "нулевого" месяца. Не исключено, что признак коррелирует с целевым случайным образом без реальной связи в данных.
C дополнительным значением 'not specified', введённым вместо пропусков, признак с информацией о наличии технических проблем у автомобиля в прошлом продемонстрировал немного более сильную связь с целевым, чем если заполнить пропуски наиболее частым значением. Для обучения модели сохраним расширенный признак.
Для остальных признаков отметим умеренную тесноту связи с целевым.
По итогу подготовки данные разделены на тренировочную и тестовую выборки, создан пайплайн для подготовки данных к обучению моделей.

2 Обучение моделей

Для решения задачи обучены следующие модели: LinearRegression, LGBMRegressor и CatBoostRegressor.

Итоги обучения модели линейной регрессии:

Среднее время обучения модели: 9.220217227935791 cекунд
Среднее время предсказания модели: 0.848421573638916 cекунд
RMSE на кросс-валидации: 2744.950070552154
RMSE на тренировочной выборке: 2734.8363934205727
Итоги обучения модели LightGBM:

Среднее время обучения модели: 3.8394303798675535 cекунд
Среднее время предсказания модели: 0.4230950832366943 cекунд
RMSE на кросс-валидации: 1746.870429660629
RMSE на тренировочной выборке: 1712.1060955608928
Итоги обучения модели CatBoost:

Среднее время обучения модели: 127.1016214688619 cекунд
Среднее время предсказания модели: 0.544654369354248 cекунд
RMSE на кросс-валидации: 1668.2588989377953
RMSE на тренировочной выборке: 1595.601729502886
3 Анализ моделей

Порог качества смогли преодолеть модели граддиентного бустинга. Качество модели CatBoost на кросс-валидации выше, чем у LightGBM. Если для компании качество важнее, чем скорость обучения, то стоит использовать именно CatBoost.

RMSE лучшей модели на тестовой выборке: 1651.179398116812
